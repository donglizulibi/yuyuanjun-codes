<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // 首先来复习一下js的内存回收机制
        // js是一种会自动回收内存的语言，如果一个数据没有变量的指代的时候
        // 这个数据所占有的内存就会被内存自动回收

        // 比如下面这个例子，一个对象的数据被两个变量指代
        // 把其中一个变量的指向改为null，但另一个变量还是指向这个数据
        // 所以这个数据所占的内存就不会被自动回收
        let obj1 = {
            name: 'xiaoming'
        }
        let obj2 = obj1

        obj1 = null

        console.log(obj2)

        // 这个例子也可以应用在数组上面
        let objArr = {
            age: 19
        }
        let arr = []
        arr[0] = objArr

        objArr = null
        console.log(arr)

        // Set
        let objSet = {
            gender: 'male'
        }
        let set = new Set()
        set.add(objSet)

        objSet = null
        console.log(set)

        // 以上都可以称为强引用类型，也就是内存中其他的变量都不指向这个数据的时候
        // 只要这个类型的变量还在指向这个数据，这个数据就可以保存

        // 但是WeakSet是一种弱引用类型
        // 也就是说在弱引用类型的变量和其他变量同时指向一个数据的情况下
        // 当时其他变量都指向null时，弱引用类型的变量也会放弃这个数据
        // 那么这个数据就被js回收了

        let objweakset = {
            city: 'shanghai'
        }
        let weakset = new WeakSet()
        weakset.add(objweakset)

        objweakset = null
        console.log(weakset) // 这里虽然显示还有数据，但可能是浏览器的问题
    </script>
</body>

</html>